---
title: LCLUC Later Stage Analyses
author: "Jessie Dearing"
date: "2025-06-26"
output: pdf_document
---

This relies on the combined dfs from 1_data_import. There is not currently any commentary in this document because I'm still running through analyses and chunking them in here as I go. 

```{r setup , include = FALSE}
library(kableExtra)
library(ggplot2)
library(janitor)
library(skimr)
library(tidyr)
library(tidyverse)
library(dplyr)
library(purrr)
```

```{r setup, include=FALSE}
# Source the script that creates `base_`
source("1_data_import.R")  # Replace with the actual script filename

# Now `base_` should exist before calling skim()
if (exists("base_")) {
  skim(base_)
}
```

```{r, include=FALSE}

#setwd("C:/Users/jessi/OneDrive - Cornell University/Documents/MSPhD/AllingtonLab_LCLUC/RStudio_WorkingDirectory")
names(base_) <- gsub("\\.x$", "", names(base_))

str(base_)
base_ <- as.data.frame(base_)
base_ <- base_ %>% 
  mutate(across(Ref, as.factor))
```

# I. LABOR

## 1. Who does the daily moves for herding? 
  Column: (labor_whoMovesDaily) 
  (broken up by soum)
```{r, echo=FALSE}
count_dailyMoves <- base_LABOR %>%
  select(Soum, labor_whoMovesDaily) %>%
  filter(!is.na(labor_whoMovesDaily)) %>%
  separate_rows(labor_whoMovesDaily, sep = ",") %>%
  mutate(
    labor_whoMovesDaily = str_trim(labor_whoMovesDaily),
    labor_whoMovesDaily = str_to_lower(labor_whoMovesDaily),
    labor_whoMovesDaily = case_when(
      labor_whoMovesDaily == "grandparents" ~ "grandparent, unspecified",
      labor_whoMovesDaily == "child" ~ "child, unspecified",
      labor_whoMovesDaily == "sibling" ~ "sibling, unspecified",
      labor_whoMovesDaily == "grandchild" ~ "grandchild, unspecified",
      TRUE ~ labor_whoMovesDaily
    )
  ) %>%
  count(Soum, labor_whoMovesDaily, sort = TRUE)

count_wide <- count_dailyMoves %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide)
```


## 2. Who undertakes herding migrations?
  Column: labor_whoMigrates
```{r, echo=FALSE}
relationship_order <- c("husband", "wife", "son(s)", "daughter(s)", "child(ren), unspecified", "brother(s)", "sibling(s), unspecified", "father",
  "mother", "grandparent(s), unspecified", "grandchild(ren), unspecified", "household head", "extended family/in-laws", "friend/neighbor(s)",
  "person(s), unspecified", "hired help", "just myself", "other", "husband. 2 sons")

count_whoMigrates <- base_LABOR %>%
  select(Soum, labor_whoMigrates) %>%
  filter(!is.na(labor_whoMigrates)) %>%
  mutate(labor_whoMigrates = str_replace(labor_whoMigrates, "Husband. 2 sons", "husband, sons")
  ) %>%
  separate_rows(labor_whoMigrates, sep = ",") %>%
  mutate(
    labor_whoMigrates = str_trim(labor_whoMigrates),
    labor_whoMigrates = str_to_lower(labor_whoMigrates),
    labor_whoMigrates = case_when(
      labor_whoMigrates == "grandparents" ~ "grandparent(s), unspecified",
      labor_whoMigrates == "grandmother" ~ "grandparent(s), unspecified",
      labor_whoMigrates == "child" ~ "child(ren), unspecified",
      labor_whoMigrates == "children" ~ "child(ren), unspecified",
      labor_whoMigrates == "son" ~ "son(s)",
      labor_whoMigrates == "2 sons" ~ "son(s)",
      labor_whoMigrates == "3 sons" ~ "son(s)",
      labor_whoMigrates == "son (student)" ~ "son(s)",
      labor_whoMigrates == "son (when he is available)" ~ "son(s)",
      labor_whoMigrates == "son 2" ~ "son(s)",
      labor_whoMigrates == "olders son comes to help" ~ "son(s)",
      labor_whoMigrates == "sons" ~ "son(s)",
      labor_whoMigrates == "daughter" ~ "daughter(s)",
      labor_whoMigrates == "1 daughter" ~ "daughter(s)",
      labor_whoMigrates == "2 daughters" ~ "daughter(s)",
      labor_whoMigrates == "2 children" ~ "child(ren), unspecified",
      labor_whoMigrates == "3 children" ~ "child(ren), unspecified",
      labor_whoMigrates == "4 children" ~ "child(ren), unspecified",
      labor_whoMigrates == "7 children" ~ "child(ren), unspecified",
      labor_whoMigrates == "older brother" ~ "brother(s)",
      labor_whoMigrates == "older brothers help" ~ "brother(s)",
      labor_whoMigrates == "sibling" ~ "sibling(s), unspecified",
      labor_whoMigrates == "siblings" ~ "sibling(s), unspecified",
      labor_whoMigrates == "2 younger siblings" ~ "sibling(s), unspecified",
      labor_whoMigrates == "3 siblings-neighbors" ~ "sibling(s), unspecified",
      labor_whoMigrates == "4 younger siblings" ~ "sibling(s), unspecified",
      labor_whoMigrates == "younger sibling" ~ "sibling(s), unspecified",
      labor_whoMigrates == "younger siblings 2" ~ "sibling(s), unspecified",
      labor_whoMigrates == "grandchild" ~ "grandchild(ren), unspecified",
      labor_whoMigrates == "grandchildren" ~ "grandchild(ren), unspecified",
      labor_whoMigrates == "grandchidlren" ~ "grandchild(ren), unspecified",
      labor_whoMigrates == "1" ~ "person(s), unspecified",
      labor_whoMigrates == "2" ~ "person(s), unspecified",
      labor_whoMigrates == "3" ~ "person(s), unspecified",
      labor_whoMigrates == "4" ~ "person(s), unspecified",
      labor_whoMigrates == "4 people" ~ "person(s), unspecified",
      labor_whoMigrates == "24" ~ "person(s), unspecified",
      labor_whoMigrates == "3-feb" ~ "person(s), unspecified",
      labor_whoMigrates == "6 people" ~ "person(s), unspecified",
      labor_whoMigrates == "everyone 3" ~ "person(s), unspecified",
      labor_whoMigrates == "everyone" ~ "person(s), unspecified",
      labor_whoMigrates == "neighbors" ~ "friend/neighbor(s)",
      labor_whoMigrates == "3 neighbors" ~ "friend/neighbor(s)",
      labor_whoMigrates == "2 neighbors" ~ "friend/neighbor(s)",
      labor_whoMigrates == "4 neighbors" ~ "friend/neighbor(s)",
      labor_whoMigrates == "neighbors 4" ~ "friend/neighbor(s)",
      labor_whoMigrates == "friends" ~ "friend/neighbor(s)",
      labor_whoMigrates == "daughter-in-law" ~ "extended family/in-laws",
      labor_whoMigrates == "son-in-law" ~ "extended family/in-laws",
      labor_whoMigrates == "father-in-law" ~ "extended family/in-laws",
      labor_whoMigrates == "brother-in-law" ~ "extended family/in-laws",
      labor_whoMigrates == "extended family members" ~ "extended family/in-laws",
      labor_whoMigrates == "herder children's families" ~ "extended family/in-laws",
      labor_whoMigrates == "in soum" ~ "extended family/in-laws",
      labor_whoMigrates == "school children" ~ "extended family/in-laws",
      labor_whoMigrates == "wide" ~ "extended family/in-laws",
      labor_whoMigrates == "younger brother and his wife" ~ "extended family/in-laws",
      labor_whoMigrates == "extended families" ~ "extended family/in-laws",
      labor_whoMigrates == "assistant herder" ~ "hired help",
      labor_whoMigrates == "herders 4" ~ "hired help",
      labor_whoMigrates == "50 year old" ~ "other",
      labor_whoMigrates == "ask for help" ~ "other",
      labor_whoMigrates == "ask someone for help" ~ "other",
      labor_whoMigrates == "don't move" ~ "other",
      labor_whoMigrates == "me" ~ "just myself",
      labor_whoMigrates == "0" ~ "just myself",
      labor_whoMigrates == "others" ~ "other",
      TRUE ~ labor_whoMigrates
    )
  ) %>%
  count(Soum, labor_whoMigrates, sort = FALSE) %>%
  mutate(labor_whoMigrates = factor(labor_whoMigrates, levels = relationship_order)) %>%
  arrange(labor_whoMigrates)

count_wide2 <- count_whoMigrates %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>%  
  ungroup()

kable(count_wide2)
```


## 3. How many people undertake migrations?
  Column: labor_numMigrates
```{r, echo=FALSE}
count_numMigrates <- base_LABOR %>%
  select(Soum, labor_numMigrates) %>%
  filter(!is.na(labor_numMigrates)) %>%
  count(Soum, labor_numMigrates, sort = TRUE)

count_wide3 <- count_numMigrates %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>% 
  ungroup()

kable(count_wide3)
```


## 4.  Does migration impact labor and/or herding practices?

#### A. Impact on labor: 
  Column: labor_migImpactLabor
```{r, echo=FALSE}
count_migImpactLabor <- base_LABOR %>%
  select(Soum, labor_migImpactLabor) %>%
  count(Soum, labor_migImpactLabor, sort = TRUE)
count_wide4 <- count_migImpactLabor %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide4)
```

#### B. Impact on herding practices:  
  Column: labor_migImpactPract
```{r, echo=FALSE}
count_migImpactPract <- base_LABOR %>%
  select(Soum, labor_migImpactPract) %>%
  count(Soum, labor_migImpactPract, sort = TRUE)
count_wide5 <- count_migImpactPract %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

kable(count_wide5, n = 30)
```

## 5. Do you hire labor?  
  Column: labor_hire
```{r, echo=FALSE}
count_hireYN <- base_LABOR %>%
  select(Soum, labor_hire) %>%
  count(Soum, labor_hire, sort = TRUE)
count_wide6 <- count_hireYN %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide6)
```



## 6. If you do hire labor, for what?

#### A. Moving the herds daily:
  Column: labor_hire_DailyMove
```{r, echo=FALSE}
count_hire_dailyMove <- base_LABOR %>%
  select(Soum, labor_hire_dailyMove) %>%
  count(Soum, labor_hire_dailyMove, sort = TRUE)
count_wide7 <- count_hire_dailyMove %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide7)
```

#### B. Moving the herds seasonally:
  Column: labor_hire_bigMove
```{r, echo=FALSE}
count_hire_bigMove <- base_LABOR %>%
  select(Soum, labor_hire_bigMove) %>%
  count(Soum, labor_hire_bigMove, sort = TRUE)
count_wide8 <- count_hire_bigMove %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide8)
```

#### C. Moving the herds for Otor: 
  Column: labor_hire_forOtor
```{r, echo=FALSE}
count_hire_Otor <- base_LABOR %>%
  select(Soum, labor_hire_forOtor) %>%
  count(Soum, labor_hire_forOtor, sort = TRUE)
count_wide9 <- count_hire_Otor %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide9)
```

#### D. Hiring for other tasks: 

  Column: labor_hire_Other
```{r, echo=FALSE}
count_hire_OTHER <- base_LABOR %>%
  select(Soum, labor_hire_Other) %>%
  separate_rows(labor_hire_Other, sep = ",") %>%
  mutate(
    labor_hire_Other = str_trim(labor_hire_Other),
    labor_hire_Other = str_to_lower(labor_hire_Other)
    ) %>% 
  count(Soum, labor_hire_Other, sort = TRUE)
count_wide10 <- count_hire_OTHER %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wide10)
```

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------







# II. TENURE

## 1. Land tenure arrangements: 

#### A. Cross-tab:
  Not the best looking, I'll work on making it more legible. Is easier to look at if it's viewed in the markdown or in the script.
```{r, echo=FALSE}
cross_tab <- base_TENURE %>%
  mutate(wintCamp = replace_na(wintCamp, "No"),
         wintContract = replace_na(wintContract, "No"),
         wintPas = replace_na(wintCamp, "No"),
         wintPasContract = replace_na(wintPasContract, "No"),
         sameCamp = replace_na(sameCamp, "No"),
         sprCamp = replace_na(sprCamp, "No"),
         sprCampContract = replace_na(sprCampContract, "No"),
         sprPasContract = replace_na(sprPasContract, "No"),
         )

cross_tab <- xtabs(~ wintCamp + 
                     wintContract + 
                     wintPas + 
                     wintPasContract + 
                     sameCamp + 
                     sprCamp + 
                     sprCampContract + 
                     sprPasContract, 
                   data = base_TENURE)
ftable(cross_tab)
```

#### B. Contingency table:
  This one looks better and is depicting the same information.
```{r, echo=FALSE}
base_contingency <- base_TENURE %>%
  mutate(wintCamp = replace_na(wintCamp, "No"),
         wintContract = replace_na(wintContract, "No"),
         wintPas = replace_na(wintPas, "No"),
         wintPasContract = replace_na(wintPasContract, "No"),
         sameCamp = replace_na(sameCamp, "No"),
         sprCamp = replace_na(sprCamp, "No"),
         sprCampContract = replace_na(sprCampContract, "No"),
         sprPasContract = replace_na(sprPasContract, "No"),
         )

contingency_table <- base_contingency %>%
  count(wintCamp, 
        wintContract, 
        wintPas, 
        wintPasContract, 
        sameCamp, 
        sprCamp, 
        sprCampContract, 
        sprPasContract, 
        sort = TRUE
        )
kable(contingency_table)
```



## 2. Contingency Tables on tenure, by Soum: 

#### A. Winter Camp (y/n): 
```{r, echo=FALSE}
tenure_table_wintCamp <- table(base_contingency$Soum, base_contingency$wintCamp)
kable(tenure_table_wintCamp)
```

#### B. Winter Camp Contract (y/n): 
```{r, echo=FALSE}
tenure_table_wintContract <- table(base_contingency$Soum, base_contingency$wintContract)
kable(tenure_table_wintContract)
```

#### C. Winter Pasture (y/n):
```{r, echo=FALSE}
tenure_table_wintPas <- table(base_contingency$Soum, base_contingency$wintPas)
kable(tenure_table_wintPas)
```

#### D. Winter Paster Contract (y/n): 
```{r, echo=FALSE}
tenure_table_wintPasContract <- table(base_contingency$Soum, base_contingency$wintPasContract)
kable(tenure_table_wintPasContract)
```

#### E. Is your winter camp your spring camp (y/n)?  
```{r, echo=FALSE}
tenure_table_sameCamp <- table(base_contingency$Soum, base_contingency$sameCamp)
kable(tenure_table_sameCamp)
```

#### F. Spring Camp? (y/n):   
```{r, echo=FALSE}
tenure_table_sprCamp <- table(base_contingency$Soum, base_contingency$sprCamp)
kable(tenure_table_sprCamp)
```

#### G. Spring Camp Contract (y/n):
```{r, echo=FALSE}
tenure_table_sprCampContract <- table(base_contingency$Soum, base_contingency$sprCampContract)
kable(tenure_table_sprCampContract)
```

#### H. Spring Pasture Contract (y/n): 
```{r, echo=FALSE}
tenure_table_sprPasContract <- table(base_contingency$Soum, base_contingency$sprPasContract)
kable(tenure_table_sprPasContract)
```
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------








# III. ALTERNATIVE LIVELIHOODS

## 1. Is someone in the household doing non-herding work?
  Column: altLife_nonHerdWork
```{r, echo=FALSE}
altLife_table_nonHerdWork <- table(base_ALTLIFE$Soum, base_ALTLIFE$altLife_nonHerdWork)
kable(altLife_table_nonHerdWork)
```

#### A. If so, who is doing the non-herding work?   
  Column: labor_hire
```{r, echo=FALSE}
count_whoNoHerdwork <- base_ALTLIFE %>%
  select(Soum, altLife_whoNoHerdwork) %>%
  filter(!is.na(altLife_whoNoHerdwork)) %>%
  separate_rows(altLife_whoNoHerdwork, sep = ",") %>%
  mutate(
    altLife_whoNoHerdwork = str_trim(altLife_whoNoHerdwork),
    altLife_whoNoHerdwork = str_to_lower(altLife_whoNoHerdwork),
    altLife_whoNoHerdwork = case_when(
      altLife_whoNoHerdwork == "son-in-law" ~ "extended family members",
      altLife_whoNoHerdwork == "doctor" ~ "not specified",
      TRUE ~ altLife_whoNoHerdwork
    )
  ) %>% 
  count(Soum, altLife_whoNoHerdwork, sort = TRUE)

count_whoNoHerdwork <- count_whoNoHerdwork %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_whoNoHerdwork %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(altLife_whoNoHerdwork = "TOTAL") %>%
  select(altLife_whoNoHerdwork, everything()) # Move label to first column

count_whoNoHerdwork <- bind_rows(count_whoNoHerdwork, total_row)
kable(count_whoNoHerdwork)
```

#### B. Is so, what is the non-herding work?  
  Column: labor_hire
```{r, echo=FALSE}
count_noHerdWhatWork <- base_ALTLIFE %>%
  select(Soum, altLife_noHerdWhatWork) %>%
  filter(!is.na(altLife_noHerdWhatWork)) %>%
  separate_rows(altLife_noHerdWhatWork, sep = ",") %>%
  mutate(
    altLife_noHerdWhatWork = str_trim(altLife_noHerdWhatWork),
    altLife_noHerdWhatWork = str_to_lower(altLife_noHerdWhatWork),
    altLife_noHerdWhatWork = case_when(
      altLife_noHerdWhatWork == "bagh governor" ~ "government leadership",
      altLife_noHerdWhatWork == "public service" ~ "government employment",
      altLife_noHerdWhatWork == "employment at soum governor office" ~ "government employment",
      altLife_noHerdWhatWork == "public servant" ~ "government employment",
      altLife_noHerdWhatWork == "soum culture center" ~ "government employment",
      altLife_noHerdWhatWork == "dance instructor at culture center" ~ "government employment",
      altLife_noHerdWhatWork == "soum center" ~ "government employment",
      altLife_noHerdWhatWork == "procurement at the governor office" ~ "government employment",
      altLife_noHerdWhatWork == "social worker in ulaanbaatar hospital" ~ "government employment",
      altLife_noHerdWhatWork == "employment in environmental agency" ~ "government employment",
      altLife_noHerdWhatWork == "mining" ~ "mining and construction",
      altLife_noHerdWhatWork == "employment in mining" ~ "mining and construction",
      altLife_noHerdWhatWork == "part-time employment in mining" ~ "mining and construction",
      altLife_noHerdWhatWork == "drives truck in mining" ~ "mining and construction",
      altLife_noHerdWhatWork == "employment in construction" ~ "mining and construction",
      altLife_noHerdWhatWork == "metal work (sometimes)" ~ "mining and construction",
      altLife_noHerdWhatWork == "plumber" ~ "mining and construction",
      altLife_noHerdWhatWork == "driver" ~ "mining and construction",
      altLife_noHerdWhatWork == "employment in restaurant" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "cook at school kitchen" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "retail business" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "cook at kindergarten" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "cashier at grocery store" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "part-time cashier at supermarket" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "any part-time job" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "running store" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "working at supermarket" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "commercial service" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "work at supermarket" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "private business" ~ "commerce-related and restaurants",
      altLife_noHerdWhatWork == "kindergarten teacher" ~ "education",
      altLife_noHerdWhatWork == "school teacher" ~ "education",
      altLife_noHerdWhatWork == "driving instructor" ~ "education",
      altLife_noHerdWhatWork == "assistant teacher at kindergarten" ~ "education",
      altLife_noHerdWhatWork == "studies in japan" ~ "education",
      altLife_noHerdWhatWork == "teacher at kindergarten" ~ "education",
      altLife_noHerdWhatWork == "subsidy for wool/hide" ~ "agriculture and pastoralist-adjacent",
      altLife_noHerdWhatWork == "working the hide" ~ "agriculture and pastoralist-adjacent",
      altLife_noHerdWhatWork == "crop farming" ~ "agriculture and pastoralist-adjacent",
      altLife_noHerdWhatWork == "dairy store" ~ "agriculture and pastoralist-adjacent",
      altLife_noHerdWhatWork == "sales from dairy products" ~ "agriculture and pastoralist-adjacent",
      altLife_noHerdWhatWork == "employment" ~ "employment unspecified",
      altLife_noHerdWhatWork == "in ulaanbaatar" ~ "employment unspecified",
      altLife_noHerdWhatWork == "pension" ~ "employment unspecified",
      altLife_noHerdWhatWork == "salary" ~ "employment unspecified",
      altLife_noHerdWhatWork == "grandmother" ~ "employment unspecified",
      altLife_noHerdWhatWork == "employed" ~ "employment unspecified",
      altLife_noHerdWhatWork == "knitting" ~ "arts, crafts, and handwork",
      altLife_noHerdWhatWork == "horse archery" ~ "arts, crafts, and handwork",
      altLife_noHerdWhatWork == "film director" ~ "arts, crafts, and handwork",
      altLife_noHerdWhatWork == "tailoring" ~ "arts, crafts, and handwork",
      altLife_noHerdWhatWork == "doctor" ~ "medical/veterinary",
      altLife_noHerdWhatWork == "veterinarian" ~ "medical/veterinary",
      altLife_noHerdWhatWork == "cleaner" ~ "mischellaneous",
      altLife_noHerdWhatWork == "head of the soum disabled community" ~ "mischellaneous",
      altLife_noHerdWhatWork == "security" ~ "mischellaneous",
      TRUE ~ altLife_noHerdWhatWork
    )
  ) %>% 
  count(Soum, altLife_noHerdWhatWork, sort = TRUE)

count_noHerdWhatWork <- count_noHerdWhatWork %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_noHerdWhatWork %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(altLife_noHerdWhatWork = "TOTAL") %>%
  select(altLife_noHerdWhatWork, everything()) # Move label to first column

count_noHerdWhatWork <- bind_rows(count_noHerdWhatWork, total_row)
kable(count_noHerdWhatWork)
```


## 2. Additional sources of income for the household? Broken up by Soum
  Column: altLife_otherInc
```{r, echo=FALSE}
count_otherInc <- base_ALTLIFE %>%
  select(Soum, altLife_otherInc) %>%
  filter(!is.na(altLife_otherInc)) %>%
  separate_rows(altLife_otherInc, sep = ",") %>%
  mutate(
    altLife_otherInc = str_trim(altLife_otherInc),
    altLife_otherInc = str_to_lower(altLife_otherInc),
    altLife_otherInc = case_when(
      altLife_otherInc == "bagh governor" ~ "government leadership",
      TRUE ~ altLife_otherInc
    )
  ) %>% 
  count(Soum, altLife_otherInc, sort = TRUE)

count_otherInc <- count_otherInc %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  # Fill missing values with 0s
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_otherInc %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(altLife_otherInc = "TOTAL") %>%
  select(altLife_otherInc, everything()) 

count_otherInc <- bind_rows(count_otherInc, total_row)

kable(count_otherInc)
```


## 3. Loans:
#### A. Number of loans taken out per year?
  Column: altLife_loansPerYr
```{r, echo=FALSE}
altLife_table_loansPerYr <- table(base_ALTLIFE$Soum, base_ALTLIFE$altLife_loansPerYr)

altLife_table_loansPerYr_total <- addmargins(altLife_table_loansPerYr)

kable(altLife_table_loansPerYr_total)
```

#### B. Loan Sizes (min, max, mean, median, range)  
  Column: altLife_loansMin/altLife_loansMax
```{r, echo=FALSE}
base_loans <- base_ALTLIFE %>%
  select(Soum, altLife_loansMin, altLife_loansMax) %>%
  group_by(Soum) %>%  # Group by Soum before summarizing
  summarise(
    min_minLn = min(altLife_loansMin, na.rm = TRUE),
    max_minLn = max(altLife_loansMin, na.rm = TRUE),
    mean_minLn = mean(altLife_loansMin, na.rm = TRUE),
    median_minLn = median(altLife_loansMin, na.rm = TRUE),
    min_maxLn = min(altLife_loansMax, na.rm = TRUE),
    max_maxLn = max(altLife_loansMax, na.rm = TRUE),
    mean_maxLn = mean(altLife_loansMax, na.rm = TRUE),
    median_maxLn = median(altLife_loansMax, na.rm = TRUE)
    )
kable(base_loans)
```

#### C. When do you typically need loans?  
  Column: altLife_loansWhenNeed
```{r, echo=FALSE}
count_loansWhenNeed <- base_ALTLIFE %>%
  select(Soum, altLife_loansWhenNeed) %>%
  filter(!is.na(altLife_loansWhenNeed)) %>%
  mutate(
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter and spring", "winter, spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter and Spring", "winter, spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "august- for school year and lunar new year", "autumn, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter-fodder", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winter-fodder", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter- require fodder", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "and Winter", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winter and petrol", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "february", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "February", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "After December", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter and preparation of fodder", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Dec", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "december", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winter-winter for fodder", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winterember", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter Nov-March", "winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winter and spring", "winter, spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "winter and Lunar new year", "winter, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter and Lunar new year", "winter, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Winter and Lunar New Year", "winter, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "spring and autumn", "spring, autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "spring-fodder", "spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Spring- before cashmere collection", "spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Lunar new year-spring", "spring, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "summer and winter", "summer, winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Sep-fodder", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn-fodder", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "prepare fodder in Autumn", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "August", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn- school year", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn- school new year", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Aug", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn-sep", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn-sep", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "October", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "September", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn- student tuition fee payment and buying fodder", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn- school year starts", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "september-school year", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn-school new year", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn-school year starts", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn -sep", "autumn"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn- for school year and lunar new year", "autumn, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn and Lunar New Year", "autumn, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn and during lunar new year", "autumn, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Lunar New Year and Sept", "autumn, lunar new year"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn and spring-lunar new year", "autumn, lunar new year, spring"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autum and winter", "autumn, winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "september and during harsh winter", "autumn, winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "autumn and winter", "autumn, winter"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Lunar New year and need of fodder", "lunar new year"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "If livestock is weak", "depends on needs"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "depends on demands", "depends on needs"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "0", "never"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "None", "never"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "one", "never"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "nnever", "never"),
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "During migration and need of fodder", "during migration, depends on needs"), 
    altLife_loansWhenNeed = str_replace(altLife_loansWhenNeed, "Autumn and during medical treatment", "autumn, during medical treatment")
  ) %>%
  separate_rows(altLife_loansWhenNeed, sep = ",") %>%
  mutate(
    altLife_loansWhenNeed = str_trim(altLife_loansWhenNeed),
    altLife_loansWhenNeed = str_to_lower(altLife_loansWhenNeed)
  ) %>% 
  count(Soum, altLife_loansWhenNeed, sort = TRUE)

count_loansWhenNeed <- count_loansWhenNeed %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_loansWhenNeed %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(altLife_loansWhenNeed = "TOTAL") %>%
  select(altLife_loansWhenNeed, everything()) 

count_loansWhenNeed <- bind_rows(count_loansWhenNeed, total_row)

kable(count_loansWhenNeed, n = 60)
```
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------







# IV. HERD MANAGEMENT

## 1. Distance for daily herding, generally:
  Column: altLife_nonHerdWork
  
#### A. All together: 
```{r, echo=FALSE}
count_DailyDist <- base_HERDMGMT %>%
  select(herdMgmt_dailyDist) %>%
  filter(!is.na(herdMgmt_dailyDist)) %>%
  count(herdMgmt_dailyDist, sort = TRUE)
kable(count_DailyDist)
```

#### B. Broken up by Soum: 
```{r, echo=FALSE}
count_DailyDist <- base_HERDMGMT %>%
  select(Soum, herdMgmt_dailyDist) %>%
  filter(!is.na(herdMgmt_dailyDist)) %>%
  count(Soum, herdMgmt_dailyDist, sort = TRUE)
count_dist1 <- count_DailyDist %>%
  pivot_wider(names_from = Soum, values_from = n, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_dist1)
```



## 2. Distances for daily herding, summer & winter: 
  Column: herdMgmt_sumDailyDist/herdMgmt_wintDailyDist
  
#### A. Basic distances, summer: 
```{r, echo=FALSE}
count_sumDailyDist <- base_HERDMGMT %>%
  select(herdMgmt_sumDailyDist) %>%
  filter(!is.na(herdMgmt_sumDailyDist)) %>%
  count(herdMgmt_sumDailyDist, sort = TRUE)
kable(count_sumDailyDist)
```

#### B. Basic distances, winter: 
```{r, echo=FALSE}
count_wintDailyDist <- base_HERDMGMT %>%
  select(herdMgmt_wintDailyDist) %>%
  filter(!is.na(herdMgmt_wintDailyDist)) %>%
  count(herdMgmt_wintDailyDist, sort = TRUE)
kable(count_wintDailyDist)
```

#### C. Basic distances, summer, by soum: 
```{r, echo=FALSE}
count_sumDailyDist2 <- base_HERDMGMT %>%
  select(Soum, herdMgmt_sumDailyDist) %>%
  filter(!is.na(herdMgmt_sumDailyDist)) %>%
  count(Soum, herdMgmt_sumDailyDist, sort = TRUE)
count_dist2 <- count_sumDailyDist2 %>%
  pivot_wider(names_from = Soum, values_from = n, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_dist2)
```

#### D. Basic distances, winter, by soum: 
```{r, echo=FALSE}
count_wintDailyDist2 <- base_HERDMGMT %>%
  select(Soum, herdMgmt_wintDailyDist) %>%
  filter(!is.na(herdMgmt_wintDailyDist)) %>%
  count(Soum, herdMgmt_wintDailyDist, sort = TRUE)
count_dist3 <- count_wintDailyDist2 %>%
  pivot_wider(names_from = Soum, values_from = n, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_dist3)
```




## 3. Do people travel greater distances for summer vs. winter?
 Column: herdMgmt_sumDailyDist/herdMgmt_wintDailyDist
 
#### A. All together: 
```{r, echo=FALSE}
count_distComparison <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_sumDailyDist > herdMgmt_wintDailyDist ~ "greater dist in summer",
      herdMgmt_sumDailyDist < herdMgmt_wintDailyDist ~ "greater dist in winter",
      herdMgmt_sumDailyDist == herdMgmt_wintDailyDist ~ "Equal"
    )
  ) %>%
  count(dist_comparison)
kable(count_distComparison)
```

#### B. Broken up by Soum: 
```{r, echo=FALSE}
count_distComparison2 <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_sumDailyDist > herdMgmt_wintDailyDist ~ "greater dist in summer",
      herdMgmt_sumDailyDist < herdMgmt_wintDailyDist ~ "greater dist in winter",
      herdMgmt_sumDailyDist == herdMgmt_wintDailyDist ~ "Equal"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")

count_dist4 <- count_distComparison2 %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_dist4 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(dist_comparison = "TOTAL") %>%
  select(dist_comparison, everything())

count_dist4 <- bind_rows(count_dist4, total_row)
kable(count_dist4)
```



## 4. Distance moved this year vs. last year: 
  Column: herdMgmt_timesMoved_thisYr/herdMgmt_timesMoved_lastYr
  
#### A. Times moved this year, broken up by Soum: 
```{r, echo=FALSE}
count_moves_thisYr <- base_HERDMGMT %>%
  select(Soum, herdMgmt_timesMoved_thisYr) %>%
  filter(!is.na(herdMgmt_timesMoved_thisYr)) %>%
  count(Soum, herdMgmt_timesMoved_thisYr, sort = TRUE)
count_moves1 <- count_moves_thisYr %>%
  pivot_wider(names_from = Soum, values_from = n, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_moves1)
```

#### B. Times moved last year, broken up by Soum: 
```{r, echo=FALSE}
count_moves_lastYr <- base_HERDMGMT %>%
  select(Soum, herdMgmt_timesMoved_lastYr) %>%
  filter(!is.na(herdMgmt_timesMoved_lastYr)) %>%
  count(Soum, herdMgmt_timesMoved_lastYr, sort = TRUE)
count_moves2 <- count_moves_lastYr %>%
  pivot_wider(names_from = Soum, values_from = n, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_moves2)

```

#### C. Times moved, this yr vs. last year, difference for everyone: 
```{r, echo=FALSE}
count_moves <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_timesMoved_thisYr > herdMgmt_timesMoved_lastYr ~ "moved more this year",
      herdMgmt_timesMoved_lastYr > herdMgmt_timesMoved_thisYr ~ "moved more last year",
      herdMgmt_timesMoved_lastYr == herdMgmt_timesMoved_thisYr ~ "Equal"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")
count_moves <- count_moves %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

total_row <- count_moves %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(dist_comparison = "TOTAL") %>%
  select(dist_comparison, everything())

count_moves <- bind_rows(count_moves, total_row)

# Display table
kable(count_moves)
```

#### D. One table showing the difference, coalesced together: 
```{r, echo=FALSE}
herd_moves <- base_HERDMGMT %>%
  mutate(
    move_diff = herdMgmt_timesMoved_thisYr - herdMgmt_timesMoved_lastYr,
    move_description = case_when(
      move_diff > 0 ~ paste("moved", move_diff, "times more this year than last year"),
      move_diff < 0 ~ paste("moved", abs(move_diff), "times fewer this year than last year"),
      move_diff == 0 ~ "moved an equal number of times"
    )
  ) %>%
  select(herdMgmt_timesMoved_lastYr, herdMgmt_timesMoved_thisYr, move_diff, move_description)
move_summary <- herd_moves %>%
  count(move_description)
kable(move_summary)
```

#### E. The differences in times moved, broken up by Soum: 
1. Bayan
```{r, echo=FALSE}
herd_moves <- base_HERDMGMT %>%
  select(Soum, herdMgmt_timesMoved_lastYr, herdMgmt_timesMoved_thisYr) %>%
  mutate(
    move_diff = herdMgmt_timesMoved_thisYr - herdMgmt_timesMoved_lastYr,
    move_description = case_when(
      move_diff > 0 ~ paste("moved", move_diff, "times more this year than last year"),
      move_diff < 0 ~ paste("moved", abs(move_diff), "times fewer this year than last year"),
      move_diff == 0 ~ "moved an equal number of times"
    ))
herd_moves_bayan <- herd_moves %>%
  filter(Soum == "Bayan")
move_summary_bayan <- herd_moves_bayan %>%
  count(move_description)
kable(move_summary_bayan)
```

2. Bayantal
```{r, echo=FALSE}
herd_moves_bayantal <- herd_moves %>%
  filter(Soum == "Bayantal")
move_summary_bayantal <- herd_moves_bayantal %>%
  count(move_description)
kable(move_summary_bayantal)
```

3. Bayansagaan
```{r, echo=FALSE}
herd_moves_bayantsagaan <- herd_moves %>%
  filter(Soum == "Bayantsagaan")
move_summary_bayantsagaan <- herd_moves_bayantsagaan %>%
  count(move_description)
kable(move_summary_bayantsagaan)
```

4. Buren
```{r, echo=FALSE}
herd_moves_buren <- herd_moves %>%
  filter(Soum == "Buren")
move_summary_buren <- herd_moves_buren %>%
  count(move_description)
kable(move_summary_buren)
```

5. Delgerkhaan
```{r, echo=FALSE}
herd_moves_delgerkhaan <- herd_moves %>%
  filter(Soum == "Delgerkhaan")
move_summary_delgerkhaan <- herd_moves_delgerkhaan %>%
  count(move_description)
kable(move_summary_delgerkhaan)
```

6. Deren
```{r, echo=FALSE}
herd_moves_deren <- herd_moves %>%
  filter(Soum == "Deren")
move_summary_deren <- herd_moves_deren %>%
  count(move_description)
kable(move_summary_deren)
```

7. Erdenedalai
```{r, echo=FALSE}
herd_moves_erdenedalai <- herd_moves %>%
  filter(Soum == "Erdenedalai")
move_summary_erdenedalai <- herd_moves_erdenedalai %>%
  count(move_description)
kable(move_summary_erdenedalai)
```

8. Sumber
```{r, echo=FALSE}
herd_moves_sumber <- herd_moves %>%
  filter(Soum == "Sumber")
move_summary_sumber <- herd_moves_sumber %>%
  count(move_description)
kable(move_summary_sumber)
```



## 5. What is the average distance of moves, now vs. 10yrs ago?
  Column: herdMgmt_avgDistMoves/herdMgmt_10yrs_avgMoveDist
  
#### A. Unsimplified:
```{r, echo=FALSE}
herd_move_dif <- base_HERDMGMT %>%
  mutate(
    move_diff = herdMgmt_10yrs_avgMoveDist - herdMgmt_avgDistMoves,
    move_description = case_when(
      move_diff > 0 ~ paste("moved", move_diff, "kilometers more 10yrs ago than last year"),
      move_diff < 0 ~ paste("moved", abs(move_diff), "kilometers less 10yrs ago than last year"),
      move_diff == 0 ~ "moved an equal amount of distance"
    )
  ) %>%
  select(herdMgmt_timesMoved_lastYr, herdMgmt_timesMoved_thisYr, move_diff, move_description)
move_summary <- herd_move_dif %>%
  count(move_description) %>% 
  arrange(desc(n))
kable(move_summary)
```

#### B. Simplified:
```{r, echo=FALSE}
herd_move_difSimp <- base_HERDMGMT %>%
  mutate(
    move_diff = herdMgmt_10yrs_avgMoveDist - herdMgmt_avgDistMoves,
    move_description = case_when(
      move_diff > 0 ~ paste("moved more 10yrs ago than last year"),
      move_diff < 0 ~ paste("moved less 10yrs ago than last year"),
      move_diff == 0 ~ "moved an equal amount of distance"
    )
  ) %>%
  select(herdMgmt_timesMoved_lastYr, herdMgmt_timesMoved_thisYr, move_diff, move_description)
move_summary <- herd_move_difSimp %>%
  count(move_description) %>% 
  arrange(desc(n))
kable(move_summary)
```



## 6. Contingency tables for having reserved various types of pasture
  Columns: herdMgmt_lastYr_Otor, herdMgmt_thisYr_Otor, herdMgmt_lastYr_wintPast, herdMgmt_thisYr_wintPast, herdMgmt_lastYr_springPast, herdMgmt_thisYr_springPast, herdMgmt_lastYr_DzudPast, herdMgmt_thisYr_DzudPast
  
#### A. Big, ugly contingency table to start: 
```{r, echo=FALSE}
contingency_pasture <- base_HERDMGMT %>%
  count(
    herdMgmt_lastYr_Otor, 
    herdMgmt_thisYr_Otor, 
    herdMgmt_lastYr_wintPast, 
    herdMgmt_thisYr_wintPast, 
    herdMgmt_lastYr_springPast, 
    herdMgmt_thisYr_springPast, 
    herdMgmt_lastYr_DzudPast, 
    herdMgmt_thisYr_DzudPast, 
    sort = TRUE
  ) %>%
  rename(
    lastYr_Otor = herdMgmt_lastYr_Otor,
    thisYr_Otor = herdMgmt_thisYr_Otor,
    lastYr_Winter = herdMgmt_lastYr_wintPast,
    thisYr_Winter = herdMgmt_thisYr_wintPast,
    lastYr_Spring = herdMgmt_lastYr_springPast,
    thisYr_Spring = herdMgmt_thisYr_springPast,
    lastYr_Dzud = herdMgmt_lastYr_DzudPast,
    thisYr_Dzud = herdMgmt_thisYr_DzudPast
  )
kable(contingency_pasture)
```

#### B. Did you undertake a fall/winter otor last year? 
```{r, echo=FALSE}
count_lastYr_Otor <- base_HERDMGMT %>%
  select(Soum, herdMgmt_lastYr_Otor) %>%
  count(Soum, herdMgmt_lastYr_Otor, sort = TRUE)
count_Otor1 <- count_lastYr_Otor %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_Otor1)
```

#### C. Are you likely to go on fall/winter otor this year?
```{r, echo=FALSE}
count_thisYr_Otor <- base_HERDMGMT %>%
  select(Soum, herdMgmt_thisYr_Otor) %>%
  count(Soum, herdMgmt_thisYr_Otor, sort = TRUE)
count_Otor2 <- count_thisYr_Otor %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_Otor2)
```

#### D. Going on fall/winter otor last year vs. this year: 
```{r, echo=FALSE}
count_OtorComp <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_lastYr_Otor == "No" & herdMgmt_thisYr_Otor == "No" ~ "Did not take Otor either year",
      herdMgmt_lastYr_Otor == "Yes" & herdMgmt_thisYr_Otor == "No" ~ "Took Otor last yr but not this yr",
      herdMgmt_lastYr_Otor == "No" & herdMgmt_thisYr_Otor == "Yes" ~ "Too Otor this yr but not last yr",
      herdMgmt_lastYr_Otor == "Yes" & herdMgmt_thisYr_Otor == "Yes" ~ "Took Otor both years"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")
count_Otor3 <- count_OtorComp %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0)
kable(count_Otor3)
```

#### E. Did you reserve winter pasture area this year? 
```{r, echo=FALSE}
count_thisYr_wintPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_thisYr_wintPast) %>%
  count(Soum, herdMgmt_thisYr_wintPast, sort = TRUE)
count_wintPast1 <- count_thisYr_wintPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wintPast1)
```

#### F. Did you reserve winter pasture area last year?
```{r, echo=FALSE}
count_lastYr_wintPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_lastYr_wintPast) %>%
  count(Soum, herdMgmt_lastYr_wintPast, sort = TRUE)
count_wintPast2 <- count_lastYr_wintPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_wintPast2)
```

#### G. Reserving winter pasture last year vs. this year: 
```{r, echo=FALSE}
count_wintPastComp <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_lastYr_wintPast == "No" & herdMgmt_thisYr_wintPast == "No" ~ "Did not reserve Winter Pasture either year",
      herdMgmt_lastYr_wintPast == "Yes" & herdMgmt_thisYr_wintPast == "No" ~ "Reserved Winter paster last yr but not this yr",
      herdMgmt_lastYr_wintPast == "No" & herdMgmt_thisYr_wintPast == "Yes" ~ "Reserved Winter Pasture this yr but not last yr",
      herdMgmt_lastYr_wintPast == "Yes" & herdMgmt_thisYr_wintPast == "Yes" ~ "Reserved Winter Pasture both yrs"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")
count_wintPast3 <- count_wintPastComp %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0)
kable(count_wintPast3)
```

#### H. Did you reserve spring pasture area this year?
```{r, echo=FALSE}
count_thisYr_sprPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_thisYr_springPast) %>%
  count(Soum, herdMgmt_thisYr_springPast, sort = TRUE)
count_sprPast1 <- count_thisYr_sprPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_sprPast1)
```

#### I. Did you reserve spring pasture area last year?
```{r, echo=FALSE}
count_lastYr_sprPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_lastYr_springPast) %>%
  count(Soum, herdMgmt_lastYr_springPast, sort = TRUE)
count_sprPast2 <- count_lastYr_sprPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_sprPast2)
```

#### J. Reserving spring pasture last year vs. this year: 
```{r, echo=FALSE}
count_sprPastComp <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_lastYr_springPast == "No" & herdMgmt_thisYr_springPast == "No" ~ "Did not reserve Spring Pasture either year",
      herdMgmt_lastYr_springPast == "Yes" & herdMgmt_thisYr_springPast == "No" ~ "Reserved Spring paster last yr but not this yr",
      herdMgmt_lastYr_springPast == "No" & herdMgmt_thisYr_springPast == "Yes" ~ "Reserved Spring Pasture this yr but not last yr",
      herdMgmt_lastYr_springPast == "Yes" & herdMgmt_thisYr_springPast == "Yes" ~ "Reserved Spring Pasture both yrs"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")
count_sprPast3 <- count_sprPastComp %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0)
kable(count_sprPast3)
```

#### K. Did you reserve dzud pasture this year? 
```{r, echo=FALSE}
count_thisYr_dzudPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_thisYr_DzudPast) %>%
  count(Soum, herdMgmt_thisYr_DzudPast, sort = TRUE)
count_dzudPast1 <- count_thisYr_dzudPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_dzudPast1)
```

#### L. Did you reserve dzud pasture last year? 
```{r, echo=FALSE}
count_lastYr_dzudPast <- base_HERDMGMT %>%
  select(Soum, herdMgmt_lastYr_DzudPast) %>%
  count(Soum, herdMgmt_lastYr_DzudPast, sort = TRUE)
count_dzudPast2 <- count_lastYr_dzudPast %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_dzudPast2)
```

#### M. Reserving spring pasture last year vs. this year: 
```{r, echo=FALSE}
count_dzudPastComp <- base_HERDMGMT %>%
  mutate(
    dist_comparison = case_when(
      herdMgmt_lastYr_DzudPast == "No" & herdMgmt_thisYr_DzudPast == "No" ~ "Did not reserve Dzud Pasture either year",
      herdMgmt_lastYr_DzudPast == "Yes" & herdMgmt_thisYr_DzudPast == "No" ~ "Reserved Dzud Pasture last yr but not this yr",
      herdMgmt_lastYr_DzudPast == "No" & herdMgmt_thisYr_DzudPast == "Yes" ~ "Reserved Dzud Pasture this yr but not last yr",
      herdMgmt_lastYr_DzudPast == "Yes" & herdMgmt_thisYr_DzudPast == "Yes" ~ "Reserved Dzud Pasture both yrs"
    )
  ) %>%
  group_by(Soum, dist_comparison) %>%
  summarise(count = n(), .groups = "drop")
count_dzudPast3 <- count_dzudPastComp %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0)
kable(count_dzudPast3)
```



## 7. Means of travel 10, 5, and 1 year ago:
  Columns: herdMgmt_10yrsAgo_herdTravel/herdMgmt_5yrsAgo_herdTravel/herdMgmt_lastYr_herdTravel 
```{r, echo=FALSE}
travel_long_clean <- base_HERDMGMT %>%
  select(Soum,
         travel_10 = herdMgmt_10yrsAgo_herdTravel,
         travel_5 = herdMgmt_5yrsAgo_herdTravel,
         travel_1 = herdMgmt_lastYr_herdTravel) %>%
  pivot_longer(
    cols = starts_with("travel_"),
    names_to = "year",
    values_to = "transport"
  ) %>%
  mutate(
    transport = str_replace_all(transport, "Camel Motorbike", "Camel, Motorbike"),
    transport = str_replace_all(transport, "Walk Horse", "Walk, Horse"),
    transport = str_replace_all(transport, "Walk Car", "Walk, Car"),
    transport = str_to_lower(transport)
  ) %>%
  separate_rows(transport, sep = ",") %>%
  mutate(
    transport = str_trim(transport),
    year = case_when(
      year == "travel_10" ~ "10",
      year == "travel_5" ~ "5",
      year == "travel_1" ~ "1"
    )
  )

count_by_year <- travel_long_clean %>%
  count(Soum, transport, year)
count_side_by_side <- count_by_year %>%
  pivot_wider(
    names_from = year,
    values_from = n,
    values_fill = 0
  ) %>%
  mutate(combined = paste0(`10`, "-", `5`, "-", `1`)) %>%
  select(Soum, transport, combined)
final_table <- count_side_by_side %>%
  pivot_wider(
    names_from = Soum,
    values_from = combined,
    values_fill = "0-0-0"
  )

total_counts <- count_by_year %>%
  group_by(transport, year) %>%
  summarise(n = sum(n), .groups = "drop") %>%
  pivot_wider(names_from = year, values_from = n, values_fill = 0) %>%
  mutate(Total = paste0(`10`, "-", `5`, "-", `1`)) %>%
  select(transport, Total)
final_table_with_total <- final_table %>%
  left_join(total_counts, by = "transport")
kable(final_table_with_total)
```



## 8. Daily distance traveled, 10, 5, and 1 year ago:
  Columns: herdMgmt_10yrsAgo_dailyDist/herdMgmt_5yrsAgo_dailyDist/herdMgmt_lastYr_dailyDist
```{r, echo=FALSE}
dist_long <- base_HERDMGMT %>%
  select(Soum,
         dist_10 = herdMgmt_10yrsAgo_dailyDist,
         dist_5 = herdMgmt_5yrsAgo_dailyDist,
         dist_1 = herdMgmt_lastYr_dailyDist) %>%
  pivot_longer(
    cols = starts_with("dist_"),
    names_to = "year",
    values_to = "distance"
  ) %>%
  mutate(
    year = case_when(
      year == "dist_10" ~ "10",
      year == "dist_5" ~ "5",
      year == "dist_1" ~ "1"
    )
  ) %>%
  filter(!is.na(distance))  # optional, if there are NAs

count_by_distance <- dist_long %>%
  count(Soum, distance, year)

distance_side_by_side <- count_by_distance %>%
  pivot_wider(
    names_from = year,
    values_from = n,
    values_fill = 0
  ) %>%
  mutate(combined = paste0(`10`, "-", `5`, "-", `1`)) %>%
  select(Soum, distance, combined)

final_distance_table <- distance_side_by_side %>%
  pivot_wider(
    names_from = Soum,
    values_from = combined,
    values_fill = "0-0-0"
  )

total_distance_counts <- count_by_distance %>%
  group_by(distance, year) %>%
  summarise(n = sum(n), .groups = "drop") %>%
  pivot_wider(names_from = year, values_from = n, values_fill = 0) %>%
  mutate(Total = paste0(`10`, "-", `5`, "-", `1`)) %>%
  select(distance, Total)
final_distance_with_total <- final_distance_table %>%
  left_join(total_distance_counts, by = "distance")
kable(final_distance_with_total, n = 45)

```



## 9. In the past five years, have you changed your herding management practices? 
  Columns: herdMgmt_past5Yrs_mgmtChanges/herdMgmt_mgmtChanges_what
  
#### A. Changed management practices (yes/no): 
```{r, echo=FALSE}
count_mgmtChanges <- base_HERDMGMT %>%
  select(Soum, herdMgmt_past5Yrs_mgmtChanges) %>%
  count(Soum, herdMgmt_past5Yrs_mgmtChanges, sort = TRUE)
count_mgmt1 <- count_mgmtChanges %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_mgmt1)
```

#### B. Changes to management that have been made: 
```{r, echo=FALSE}
count_mgmtChanges <- base_HERDMGMT %>%
  select(Soum, herdMgmt_mgmtChanges_what) %>%
  filter(!is.na(herdMgmt_mgmtChanges_what)) %>%
  separate_rows(herdMgmt_mgmtChanges_what, sep = ",") %>%
  mutate(
    herdMgmt_mgmtChanges_what = str_trim(herdMgmt_mgmtChanges_what),
    herdMgmt_mgmtChanges_what = str_to_lower(herdMgmt_mgmtChanges_what),
    herdMgmt_mgmtChanges_what = case_when(
      herdMgmt_mgmtChanges_what == "reduced the herd size" ~ "reduced the overall herd size",
      herdMgmt_mgmtChanges_what == "reduced the size of herd" ~ "reduced the overall herd size",
      herdMgmt_mgmtChanges_what == "save winter and spring pasture" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "moved to better pasture area" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "changed winter and spring pasture" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "migrate to land with more salt marsh and wild leek" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "follow the livestock during winter" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "stopped migrating to winter camp early" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "herding from aimag" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "use summer pasture freely" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "increased pasture land" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "reserved pasture areas" ~ "reserved/moved to improved pasture",
      herdMgmt_mgmtChanges_what == "changed the breeder livestock (male)" ~ "improved the quality of the livestock",
      herdMgmt_mgmtChanges_what == "improve the quality of the livestock" ~ "improved the quality of the livestock",
      herdMgmt_mgmtChanges_what == "producing less dairy product" ~ "Engaged less in dairy farming",
      herdMgmt_mgmtChanges_what == "dug a new water well" ~ "Improved water supply",
      herdMgmt_mgmtChanges_what == "maintain livestock numbers" ~ "maintain the overall herd size",
      TRUE ~ herdMgmt_mgmtChanges_what
    )
  ) %>%
  count(Soum, herdMgmt_mgmtChanges_what, sort = TRUE)

count_herdChg1 <- count_mgmtChanges %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup() %>%
  arrange(desc(Total))  # <- This line orders by Total in descending order

kable(count_herdChg1, n = 30)
```



## 10. Do you have plans to make changes to management practices in the next 5 years? 
  Columns: herdMgmt_next5Yrs_mgmtChanges/herdMgmt_futureChg_what
  
#### A. Planning to change management practices (yes/no): 
```{r, echo=FALSE}
count_futureChg <- base_HERDMGMT %>%
  select(Soum, herdMgmt_next5Yrs_mgmtChanges) %>%
  count(Soum, herdMgmt_next5Yrs_mgmtChanges, sort = TRUE)
count_mgmt2 <- count_futureChg %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_mgmt2)
```
#### B. Planned changes to management practices: 
```{r, echo=FALSE}
count_futureChanges <- base_HERDMGMT %>%
  select(Soum, herdMgmt_futureChg_what) %>%
  filter(!is.na(herdMgmt_futureChg_what)) %>%
  separate_rows(herdMgmt_futureChg_what, sep = ",") %>%
  mutate(
    herdMgmt_futureChg_what = str_trim(herdMgmt_futureChg_what),
    herdMgmt_futureChg_what = str_to_lower(herdMgmt_futureChg_what),
    herdMgmt_futureChg_what = case_when(
      herdMgmt_futureChg_what == "fence needlegrass" ~ "fence the pasture",
      herdMgmt_futureChg_what == "fence hay-making area" ~ "fence the pasture",
      herdMgmt_futureChg_what == "fence grazing area" ~ "fence the pasture",
      herdMgmt_futureChg_what == "fence the grazing area" ~ "fence the pasture",
      herdMgmt_futureChg_what == "fence needlegrass" ~ "fence the pasture",
      herdMgmt_futureChg_what == "fencing the pasture" ~ "fence the pasture",
      herdMgmt_futureChg_what == "planting pasture grass" ~ "plant pasture grass",
      herdMgmt_futureChg_what == "dig a water well" ~ "improve water supply",
      herdMgmt_futureChg_what == "dig for water" ~ "improve water supply",
      herdMgmt_futureChg_what == "reduced the herd size" ~ "reduce the overall herd size",
      herdMgmt_futureChg_what == "reduce the herd size" ~ "reduce the overall herd size",
      herdMgmt_futureChg_what == "reduce the number of smaller animals" ~ "reduce the overall herd size",
      herdMgmt_futureChg_what == "sell out the lambs" ~ "reduce the overall herd size",
      herdMgmt_futureChg_what == "maintain livestock numbers" ~ "maintain the overall herd size",
      herdMgmt_futureChg_what == "maintain cows only" ~ "maintain the overall herd size",
      herdMgmt_futureChg_what == "maintain the bigger animals" ~ "maintain the overall herd size",
      herdMgmt_futureChg_what == "increase the herd size" ~ "increase the overall herd size",
      herdMgmt_futureChg_what == "develop milk farming" ~ "Engage more in dairy farming",
      herdMgmt_futureChg_what == "make nicer dairy products" ~ "Engage more in dairy farming",
      herdMgmt_futureChg_what == "adopt intensive cow farming" ~ "Engage more in dairy farming",
      herdMgmt_futureChg_what == "adopt intensive animal husbandry" ~ "improve the quality of the livestock",
      herdMgmt_futureChg_what == "changed the breeder livestock (male)" ~ "improve the quality of the livestock",
      herdMgmt_futureChg_what == "focus on one type of animal" ~ "improve the quality of the livestock",
      herdMgmt_futureChg_what == "improve the fattening of animals" ~ "improve the quality of the livestock",
      herdMgmt_futureChg_what == "reserve pasture areas" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "need better pasture as horses are dominant" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "move to a better pasture area" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "change spring/winter camps" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "increase the number of camps" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "find own winter camp" ~ "reserve/move to improved pasture",
      herdMgmt_futureChg_what == "prepare forage" ~ "forage/fodder related",
      herdMgmt_futureChg_what == "run irrigated crop farming" ~ "forage/fodder related",
      TRUE ~ herdMgmt_futureChg_what
    )
  ) %>%
  count(Soum, herdMgmt_futureChg_what, sort = TRUE)

count_herdChg2 <- count_futureChanges %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup() %>%
  arrange(desc(Total))  # <- This line orders by Total in descending order

kable(count_herdChg2, n = 40)
```



## 11. Are there changes you want to make to your management practices but can't?
  Columns: herdMgmt_whatChanges_cantMake/herdMgmt_chg_limitingFactor
  
#### A. (yes/no): 
```{r, echo=FALSE}
count_hopeChg <- base_HERDMGMT %>%
  select(Soum, herdMgmt_whatChanges_cantMake) %>%
  count(Soum, herdMgmt_whatChanges_cantMake, sort = TRUE)
count_mgmt3 <- count_hopeChg %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(count_mgmt3)
```

#### B. Barrier to making changes to management practices: 
```{r, echo=FALSE}
count_cantChg <- base_HERDMGMT %>%
  select(Soum, herdMgmt_chg_limitingFactor) %>%
  separate_rows(herdMgmt_chg_limitingFactor, sep = ",") %>%
  mutate(
    herdMgmt_chg_limitingFactor = str_trim(herdMgmt_chg_limitingFactor),
    herdMgmt_chg_limitingFactor = str_to_lower(herdMgmt_chg_limitingFactor),
    herdMgmt_chg_limitingFactor = case_when(
      herdMgmt_chg_limitingFactor == "lacking human capacity" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "lacking of human capacity" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "need a pasture specialist" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "looking after children" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "lack of technical skills" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "lack of solidarity" ~ "lack of human capacity/skills",
      herdMgmt_chg_limitingFactor == "high expenses" ~ "financial difficulty",
      herdMgmt_chg_limitingFactor == "inflation" ~ "financial difficulty",
      herdMgmt_chg_limitingFactor == "economy" ~ "financial difficulty",
      herdMgmt_chg_limitingFactor == "fencing the pasture" ~ "fencing related",
      herdMgmt_chg_limitingFactor == "fence needlegrass" ~ "fencing related",
      herdMgmt_chg_limitingFactor == "fence haymaking area" ~ "fencing related",
      herdMgmt_chg_limitingFactor == "fencing a small area is not effective" ~ "fencing related",
      herdMgmt_chg_limitingFactor == "critiques from other herders around building fences in grazing areas" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "delayed resolution on land issue" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "other herders' livestock grazed" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "protect pasture" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "insufficient legal framework" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "expanding the area is not possible as it will overlap others' land" ~ "legal issues/conflict with other herders",
      herdMgmt_chg_limitingFactor == "insufficient water well" ~ "insufficient water resources",
      herdMgmt_chg_limitingFactor == "establish more water points" ~ "insufficient water resources",
      herdMgmt_chg_limitingFactor == "flooding" ~ "insufficient water resources",
      herdMgmt_chg_limitingFactor == "lack of materials" ~ "insufficient land, equipment, or materials",
      herdMgmt_chg_limitingFactor == "lack of equipment" ~ "insufficient land, equipment, or materials",
      herdMgmt_chg_limitingFactor == "lacking adequate land for activities" ~ "insufficient land, equipment, or materials",
      herdMgmt_chg_limitingFactor == "lack of adequate land for activities" ~ "insufficient land, equipment, or materials",
      herdMgmt_chg_limitingFactor == "no projects/programs" ~ "little attention/resources for herders",
      herdMgmt_chg_limitingFactor == "low attention to herders" ~ "little attention/resources for herders",
      herdMgmt_chg_limitingFactor == "need to plant pasture grass" ~ "degraded pastureland",
      herdMgmt_chg_limitingFactor == "low price of products" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "difficulty in selling animals" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "herd beef cattle breeds" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "improve the herd quality" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "small size of herds" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "animal quality" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "selling the livestock products directly to the manufacturers/not through middlemen" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "environmental pollution and threats to humans/animals imposed by fluorspar mining" ~ "difficulties in selling/breeding livestock",
      herdMgmt_chg_limitingFactor == "have dairy cattle breeds" ~ "difficulties in selling/breeding/managing livestock",
      herdMgmt_chg_limitingFactor == "camp/building renovations" ~ "lack of time",
          TRUE ~ herdMgmt_chg_limitingFactor
    )
  ) %>%
  count(Soum, herdMgmt_chg_limitingFactor, sort = TRUE)

count_cantChg2 <- count_cantChg %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup() %>%
  arrange(desc(Total))  # <- This line orders by Total in descending order

kable(count_cantChg2, n = 50)
```



## 12. Condition and degree of pastoral change:
  Columns: herdMgmt_pastureCon_chg_yn/herdMgmt_pastureCon_chg_deg
```{r, echo=FALSE}
count_pastureCon <- base_HERDMGMT %>%
  mutate(
    condition_comparison = case_when(
      herdMgmt_pastureCon_chg_yn == "Degraded" & herdMgmt_pastureCon_chg_deg == "Slight" ~ "Slightly Degraded",
      herdMgmt_pastureCon_chg_yn == "Degraded" & herdMgmt_pastureCon_chg_deg == "Medium" ~ "Moderately Degraded",
      herdMgmt_pastureCon_chg_yn == "Degraded" & herdMgmt_pastureCon_chg_deg == "Substantial" ~ "Substantially Degraded",
      herdMgmt_pastureCon_chg_yn == "No change" ~ "No change",
      herdMgmt_pastureCon_chg_yn == "Improved" & herdMgmt_pastureCon_chg_deg == "Slight" ~ "Slightly Improved",
      herdMgmt_pastureCon_chg_yn == "Improved" & herdMgmt_pastureCon_chg_deg == "Medium" ~ "Moderately Improved",
      herdMgmt_pastureCon_chg_yn == "Improved" & herdMgmt_pastureCon_chg_deg == "Substantial" ~ "Substantially Improved"
    )
  ) %>%
  group_by(Soum, condition_comparison) %>%
  summarise(count = n(), .groups = "drop") %>%
  pivot_wider(names_from = Soum, values_from = count, values_fill = 0) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()

kable(count_pastureCon)
```
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------






# V. LIVESTOCK
## 1. Livestock Counts, multiple ways:
  Column: livestock_2023_camel/livestock_2023_cow/livestock_2023_horse/livestock_2023_sheep/livestock_2023_goat/livestock_2019_camel/livestock_2019_cow/livestock_2019_horse/livestock_2019_sheep/livestock_2019_goat
  
#### A. Total counts in 2019 vs. 2023, by Bag: 
```{r, echo=FALSE}
lvstk_count_bag1 <- base_LIVESTOCK %>%
  pivot_longer(
    cols = starts_with("livestock_"),
    names_to = c("year", "livestock_type"),
    names_pattern = "livestock_(\\d{4})_(.*)",
    values_to = "count"
  )
lvstk_count_bag1 <- lvstk_count_bag1 %>%
  group_by(Soum, bag, livestock_type, year) %>%
  summarise(total_count = sum(count, na.rm = TRUE), .groups = "drop")
lvstk_count_bag1 <- lvstk_count_bag1 %>%
  unite(col = "animal_year", livestock_type, year) %>%
  pivot_wider(
    names_from = animal_year,
    values_from = total_count
  ) %>%
  arrange(Soum, bag)
kable(lvstk_count_bag1, n = 33)
```

#### B. Total counts in 2019 vs. 2023, by Soum: 
```{r, echo=FALSE}
lvstk_count_soum1 <- base_LIVESTOCK %>%
  pivot_longer(
    cols = starts_with("livestock_"),
    names_to = c("year", "livestock_type"),
    names_pattern = "livestock_(\\d{4})_(.*)",
    values_to = "count"
  )
lvstk_count_soum1 <- lvstk_count_soum1 %>%
  group_by(Soum, livestock_type, year) %>%
  summarise(total_count = sum(count, na.rm = TRUE), .groups = "drop")
lvstk_count_soum1 <- lvstk_count_soum1 %>%
  unite(col = "animal_year", livestock_type, year) %>%
  pivot_wider(
    names_from = animal_year,
    values_from = total_count
  ) %>%
  arrange(Soum)
kable(lvstk_count_soum1, n = 35)

```

#### C. Have certain types of livestock increased or decreased? by Bag: 
```{r, echo=FALSE}
lvstk_count_bag2 <- lvstk_count_bag1 %>%
  mutate(
    camel_comparison = case_when(camel_2023 > camel_2019 ~ "2023: more camels", camel_2023 < camel_2019 ~ "2023: fewer camels", camel_2023 == camel_2019 ~ "2023: same camels",
      TRUE ~ NA_character_),
    cow_comparison = case_when(cow_2023 > cow_2019 ~ "2023: more cows", cow_2023 < cow_2019 ~ "2023: fewer cows", cow_2023 == cow_2019 ~ "2023: same cows",
      TRUE ~ NA_character_),
    horse_comparison = case_when(horse_2023 > horse_2019 ~ "2023: more horses", horse_2023 < horse_2019 ~ "2023: fewer horses", horse_2023 == horse_2019 ~ "2023: same horses",
      TRUE ~ NA_character_),
    sheep_comparison = case_when(sheep_2023 > sheep_2019 ~ "2023: more sheep", sheep_2023 < sheep_2019 ~ "2023: fewer sheep", sheep_2023 == sheep_2019 ~ "2023: same sheep",
      TRUE ~ NA_character_),
    goat_comparison = case_when(goat_2023 > goat_2019 ~ "2023: more goats", goat_2023 < goat_2019 ~ "2023: fewer goats", goat_2023 == goat_2019 ~ "2023: same goats",
      TRUE ~ NA_character_)
    )
lvstk_count_bag2 <- lvstk_count_bag2 %>%
 select(-camel_2019, -camel_2023, -horse_2019, -horse_2023, -cow_2019, -cow_2023, -goat_2019, -goat_2023, -sheep_2019, -sheep_2023)
kable(lvstk_count_bag2, n = 33)
```

#### D. Have certain types of livestock increased or decreased? How many Bags for each category: 
```{r, echo=FALSE}
lvstk_count_bag3 <- lvstk_count_bag2 %>%
  pivot_longer(
    cols = ends_with("_comparison"),
    names_to = "livestock_type",
    values_to = "comparison"
  )
lvstk_count_bag3 <- lvstk_count_bag3 %>%
  count(livestock_type, comparison) %>%
  arrange(livestock_type, desc(n))
kable(lvstk_count_bag3)
```

#### E. Have certain types of livestock increased or decreased? by Soum: 
```{r, echo=FALSE}
lvstk_count_soum2 <- lvstk_count_soum1 %>%
  mutate(
    camel_comparison = case_when(camel_2023 > camel_2019 ~ "2023: more camels", camel_2023 < camel_2019 ~ "2023: fewer camels", camel_2023 == camel_2019 ~ "2023: same camels",
      TRUE ~ NA_character_),
    cow_comparison = case_when(cow_2023 > cow_2019 ~ "2023: more cows", cow_2023 < cow_2019 ~ "2023: fewer cows", cow_2023 == cow_2019 ~ "2023: same cows",
      TRUE ~ NA_character_),
    horse_comparison = case_when(horse_2023 > horse_2019 ~ "2023: more horses", horse_2023 < horse_2019 ~ "2023: fewer horses", horse_2023 == horse_2019 ~ "2023: same horses",
      TRUE ~ NA_character_),
    sheep_comparison = case_when(sheep_2023 > sheep_2019 ~ "2023: more sheep", sheep_2023 < sheep_2019 ~ "2023: fewer sheep", sheep_2023 == sheep_2019 ~ "2023: same sheep",
      TRUE ~ NA_character_),
    goat_comparison = case_when(goat_2023 > goat_2019 ~ "2023: more goats", goat_2023 < goat_2019 ~ "2023: fewer goats", goat_2023 == goat_2019 ~ "2023: same goats",
      TRUE ~ NA_character_)
    )
lvstk_count_soum2 <- lvstk_count_soum2 %>%
  select(-camel_2019, -camel_2023, -horse_2019, -horse_2023, -cow_2019, -cow_2023, -goat_2019, -goat_2023, -sheep_2019, -sheep_2023)
kable(lvstk_count_soum2, n = 33)
```

#### F. Have certain types of livestock increased or decreased? How many Soums for each category:  
```{r, echo=FALSE}
lvstk_count_soum3 <- lvstk_count_soum2 %>%
  pivot_longer(
    cols = ends_with("_comparison"),
    names_to = "livestock_type",
    values_to = "comparison"
  )
lvstk_count_soum3 <- lvstk_count_soum3 %>%
  count(livestock_type, comparison) %>%
  arrange(livestock_type, desc(n))
kable(lvstk_count_soum3)
```
 
 

## 2. SFU Counts, multiple ways:
  Column: livestock_2023_camel/livestock_2023_cow/livestock_2023_horse/livestock_2023_sheep/livestock_2023_goat/livestock_2019_camel/livestock_2019_cow/livestock_2019_horse/livestock_2019_sheep/livestock_2019_goat
  
#### A. OVERALL SFU. : 
```{r, echo=FALSE}
SFU_count <- base_LIVESTOCK %>%
  pivot_longer(cols = starts_with("livestock_"), names_to = c("year", "livestock_type"), names_pattern = "livestock_(\\d{4})_(.*)", values_to = "count")
SFU_count <- SFU_count %>%
  mutate(
    sfu_factor = case_when(livestock_type == "sheep" ~ 1, livestock_type == "goat" ~ 0.9, livestock_type == "cow" ~ 6, livestock_type == "horse" ~ 7, livestock_type == "camel" ~ 5,
                           TRUE ~ NA_real_),
    sfu_total = count * sfu_factor)
SFU_count <- SFU_count %>%
  group_by(year) %>%
  summarise(SFU = sum(sfu_total, na.rm = TRUE), .groups = "drop")
SFU_count <- SFU_count %>%
  pivot_wider(names_from = year, values_from = SFU, names_prefix = "SFU_")
kable(SFU_count, n = 33)
```

#### B. SFU by Bag: 
```{r, echo=FALSE}
SFU_count_bag1 <- base_LIVESTOCK %>%
  pivot_longer(cols = starts_with("livestock_"), names_to = c("year", "livestock_type"), names_pattern = "livestock_(\\d{4})_(.*)", values_to = "count")
SFU_count_bag1 <- SFU_count_bag1 %>%
  mutate(
    sfu_factor = case_when(livestock_type == "sheep" ~ 1, livestock_type == "goat" ~ 0.9, livestock_type == "cow" ~ 6, livestock_type == "horse" ~ 7, livestock_type == "camel" ~ 5,
      TRUE ~ NA_real_),
    sfu_total = count * sfu_factor)
SFU_count_bag1 <- SFU_count_bag1 %>%
  group_by(Soum, bag, year) %>%
  summarise(SFU = sum(sfu_total, na.rm = TRUE), .groups = "drop")
SFU_count_bag1 <- SFU_count_bag1 %>%
  pivot_wider(names_from = year, values_from = SFU, names_prefix = "SFU_") %>%
  arrange(Soum, bag)
SFU_count_bag1 <- SFU_count_bag1 %>% 
mutate(
  SFU_comparison = case_when(SFU_2019 > SFU_2023 ~ "2023: less SFU", SFU_2023 > SFU_2019 ~ "2023: greater SFU",
                               TRUE ~ NA_character_))
kable(SFU_count_bag1, n = 33)
```

#### C. SFU by Bag, summarized: 
```{r, echo=FALSE}
SFU_count_bag2 <- SFU_count_bag1 %>%
  pivot_longer(
    cols = ends_with("_comparison"),
    names_to = "livestock_type",
    values_to = "comparison"
  )
SFU_count_bag2 <- SFU_count_bag2 %>%
  count(livestock_type, comparison) %>%
  arrange(livestock_type, desc(n))
kable(SFU_count_bag2)
```

#### D. SFU by Soum: 
```{r, echo=FALSE}
SFU_count_soum1 <- base_LIVESTOCK %>%
  pivot_longer(cols = starts_with("livestock_"), names_to = c("year", "livestock_type"), names_pattern = "livestock_(\\d{4})_(.*)", values_to = "count")
SFU_count_soum1 <- SFU_count_soum1 %>%
  mutate(
    sfu_factor = case_when(livestock_type == "sheep" ~ 1, livestock_type == "goat" ~ 0.9, livestock_type == "cow" ~ 6, livestock_type == "horse" ~ 7, livestock_type == "camel" ~ 5,
                           TRUE ~ NA_real_),
    sfu_total = count * sfu_factor)
SFU_count_soum1 <- SFU_count_soum1 %>%
  group_by(Soum, year) %>%
  summarise(SFU = sum(sfu_total, na.rm = TRUE), .groups = "drop")
SFU_count_soum1 <- SFU_count_soum1 %>%
  pivot_wider(names_from = year, values_from = SFU, names_prefix = "SFU_") %>%
  arrange(Soum)
SFU_count_soum1 <- SFU_count_soum1 %>% 
  mutate(
    SFU_comparison = case_when(SFU_2019 > SFU_2023 ~ "2023: less SFU", SFU_2023 > SFU_2019 ~ "2023: greater SFU",
                               TRUE ~ NA_character_))
kable(SFU_count_soum1, n = 33)
```



## 3. Did you purchase supplemental fodder last year?
  Column: lastYr_fodder
  
#### A. All answers: 
```{r, echo=FALSE}
suppFodd <- base_LIVESTOCK %>%
  select(lastYr_fodder) %>%
  count(lastYr_fodder, sort = TRUE)
suppFodd <- suppFodd %>%
  pivot_wider(
    names_from = lastYr_fodder,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(suppFodd)
```

#### B. By Bag: 
```{r, echo=FALSE}
count_suppFodd_lastYr <- base_LIVESTOCK %>%
  select(Soum, bag, lastYr_fodder) %>%
  group_by(Soum, bag, lastYr_fodder) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, bag, desc(n))
count_suppFodd_lastYr <- count_suppFodd_lastYr %>%
  pivot_wider(
    names_from = lastYr_fodder,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)
kable(count_suppFodd_lastYr, n = 33)
```

#### C. By Soum: 
```{r, echo=FALSE}
count_suppFodd_lastYr2 <- base_LIVESTOCK %>%
  select(Soum, lastYr_fodder) %>%
  group_by(Soum, lastYr_fodder) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, desc(n))
count_suppFodd_lastYr2 <- count_suppFodd_lastYr2 %>%
  pivot_wider(
    names_from = lastYr_fodder,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum)
kable(count_suppFodd_lastYr2, n = 33)
```



## 4. Do you plan to purchase supplemental fodder this year?:
  Column: thisYr_fodder
  
#### A. All answers: 
```{r, echo=FALSE}
suppFodd2 <- base_LIVESTOCK %>%
  select(thisYr_fodder) %>%
  count(thisYr_fodder, sort = TRUE)
suppFodd2 <- suppFodd2 %>%
  pivot_wider(
    names_from = thisYr_fodder,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(suppFodd2)
```

#### B. By Bag: 
```{r, echo=FALSE}
suppFodd_thisYr_bag <- base_LIVESTOCK %>%
  select(Soum, bag, thisYr_fodder) %>%
  group_by(Soum, bag, thisYr_fodder) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, bag, desc(n))
suppFodd_thisYr_bag <- suppFodd_thisYr_bag %>%
  pivot_wider(
    names_from = thisYr_fodder,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)
kable(suppFodd_thisYr_bag, n = 33)
```

#### C. By Soum: 
```{r, echo=FALSE}
suppFodd_thisYr_soum <- base_LIVESTOCK %>%
  select(Soum, thisYr_fodder) %>%
  group_by(Soum, thisYr_fodder) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, desc(n))
suppFodd_thisYr_soum <- suppFodd_thisYr_soum %>%
  pivot_wider(
    names_from = thisYr_fodder,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum)
kable(suppFodd_thisYr_soum, n = 33)
```



## 5. Have you noticed any long term shifts in vegetation/forage?:
  Column: vegShifts_yn/vegShifts_quanQual
  
#### A. Yes or no, and how so?: 
```{r, echo=FALSE}
pastureChg1 <- base_LIVESTOCK %>% 
  select(Soum, bag, vegShifts_yn, vegShifts_quanQual) %>%
  mutate(
    condition_comparison = case_when(
      vegShifts_yn == "Yes" & vegShifts_quanQual == "Quantity" ~ "Yes: Quantity",
      vegShifts_yn == "Yes" & vegShifts_quanQual == "Quality" ~ "Yes: Quality",
      vegShifts_yn == "Yes" & vegShifts_quanQual == "Both" ~ "Yes: Both",
      vegShifts_yn == "No" ~ "No change",
      TRUE ~ "Unclear"
    )
  ) %>%
  group_by(Soum, bag, condition_comparison) %>%
  summarise(count = n(), .groups = "drop") %>%
  pivot_wider(
    names_from = condition_comparison,
    values_from = count,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)

totals_row <- pastureChg1 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL", bag = "") %>%
  select(Soum, bag, everything())

pastureChg1 <- bind_rows(pastureChg1, totals_row)
kable(pastureChg1, n = 33)
```

#### B. If so, what type of change? Big ugly table:
  Column: livestock_vegShifts_type
```{r, echo=FALSE}
pastureChg2 <- base_LIVESTOCK %>%
  select(vegShifts_type) %>%
  filter(!is.na(vegShifts_type)) %>%
  separate_rows(vegShifts_type, sep = ",") %>%
  mutate(
    vegShifts_type = str_trim(vegShifts_type),
    vegShifts_type = str_to_lower(vegShifts_type)
  ) %>%
  count(vegShifts_type, sort = TRUE)
kable(pastureChg2, n = 50)

```

#### C. If so, what type of change? Big ugly table broken up by Soum: 
```{r, echo=FALSE}
pastureChg3 <- base_LIVESTOCK %>%
  select(Soum, vegShifts_type) %>%
  filter(!is.na(vegShifts_type)) %>%
  separate_rows(vegShifts_type, sep = ",") %>%
  mutate(
    vegShifts_type = str_trim(vegShifts_type),
    vegShifts_type = str_to_lower(vegShifts_type)
  ) %>%
  count(Soum, vegShifts_type, sort = TRUE)
pastureChg3 <- pastureChg3 %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>%  
  ungroup()
kable(pastureChg3, n = 40)
```

#### D. If so, what type of change? Bucketed verion: 
```{r, echo=FALSE}
pastureChg4 <- base_LIVESTOCK %>%
  select(Soum, vegShifts_type) %>%
  filter(!is.na(vegShifts_type)) %>%
  mutate(vegShifts_type = str_replace(vegShifts_type, "Shorter/sparser vegetation, Reduced wild onion abundance Higher number of mice", "shorter/sparser vegetation, reduced wild onion abundance, higher number of mice")
  ) %>%
  separate_rows(vegShifts_type, sep = ",") %>%
  mutate(
    vegShifts_type = str_trim(vegShifts_type),
    vegShifts_type = str_to_lower(vegShifts_type),
    vegShifts_type = case_when(
            vegShifts_type == "reduced plant regeneration" ~ "less vegetation overall",
            vegShifts_type == "better vegetation in some years" ~ "less vegetation overall",
            vegShifts_type == "no more forbs" ~ "less vegetation overall",
            vegShifts_type == "reduced precipitation" ~ "precipitation issues",
            vegShifts_type == "delayed precipitation" ~ "precipitation issues",
            vegShifts_type == "improved had drought 5 years ago" ~ "precipitation issues",
            vegShifts_type == "more snow" ~ "precipitation issues",
            vegShifts_type == "changing climate" ~ "changing climate in general",
            vegShifts_type == "higher temperature in summer" ~ "changing climate in general",
            vegShifts_type == "later summer" ~ "changing climate in general",
            vegShifts_type == "longer spring" ~ "changing climate in general",
            vegShifts_type == "not much snow since 2000 except for this year to feed the soil" ~ "changing climate in general",
            vegShifts_type == "varied year by year" ~ "changing climate in general",
            vegShifts_type == "seasonal changes" ~ "changing climate in general",
            vegShifts_type == "desertification" ~ "desertification issues",
            vegShifts_type == "more sand" ~ "desertification issues",
            vegShifts_type == "dust/land degredation by mining trucks" ~ "desertification issues",
            vegShifts_type == "sparser soil" ~ "desertification issues",
            vegShifts_type == "higher frequency of dzud" ~ "dzud issues",
            vegShifts_type == "disappearance of native plants" ~ "reduced plant species diversity",
            vegShifts_type == "fewer native plants" ~ "reduced plant species diversity",
            vegShifts_type == "decrease in certain weed" ~ "reduced plant species diversity",
            vegShifts_type == "reduced number of plant species" ~ "reduced plant species diversity",
            vegShifts_type == "more brown grass" ~ "more weeds",
            vegShifts_type == "more needlegrass" ~ "more weeds",
            vegShifts_type == "reduced wild onion abundance" ~ "less nutritious plants",
            vegShifts_type == "increase number of animals that has brought change" ~ "overgrazing",
            vegShifts_type == "need to move more regularly" ~ "overgrazing",
      TRUE ~ vegShifts_type
    )
  ) %>%
  count(Soum, vegShifts_type, sort = TRUE)

pastureChg4 <- pastureChg4 %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>%  
  ungroup()
kable(pastureChg4, n = 45)

```



## 6. Has your herd size changed over the last five years?:
  Column: past5yrs_herdsize
  
#### A. All answers: 
```{r, echo=FALSE}
past5yrs_herdsize1 <- base_LIVESTOCK %>%
  select(past5yrs_herdsize) %>%
  count(past5yrs_herdsize, sort = TRUE)
past5yrs_herdsize1 <- past5yrs_herdsize1 %>%
  pivot_wider(
    names_from = past5yrs_herdsize,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(past5yrs_herdsize1)
```

#### B. by Bag: 
```{r, echo=FALSE}
past5yrs_herdsize2 <- base_LIVESTOCK %>%
  select(Soum, bag, past5yrs_herdsize) %>%
  group_by(Soum, bag, past5yrs_herdsize) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, bag, desc(n))
past5yrs_herdsize2 <- past5yrs_herdsize2 %>%
  pivot_wider(
    names_from = past5yrs_herdsize,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)

totals_row <- past5yrs_herdsize2 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL", bag = "") %>%
  select(Soum, bag, everything())

past5yrs_herdsize2 <- bind_rows(past5yrs_herdsize2, totals_row)

kable(past5yrs_herdsize2, n = 33)
```

#### C. by Soum: 
```{r, echo=FALSE}
past5yrs_herdsize3 <- base_LIVESTOCK %>%
  select(Soum, past5yrs_herdsize) %>%
  group_by(Soum, past5yrs_herdsize) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, desc(n))
past5yrs_herdsize3 <- past5yrs_herdsize3 %>%
  pivot_wider(
    names_from = past5yrs_herdsize,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum)


totals_row <- past5yrs_herdsize3 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL") %>%
  select(Soum, everything())

past5yrs_herdsize3 <- bind_rows(past5yrs_herdsize3, totals_row)

kable(past5yrs_herdsize3, n = 33)

```



## 7. If your herd size has increased, what are the reasons?:
  Column: past5yrs_herdInc
```{r, echo=FALSE}
past5yrs_herdInc1 <- base_LIVESTOCK %>%
  select(Soum, past5yrs_herdInc) %>%
  filter(!is.na(past5yrs_herdInc)) %>%
  separate_rows(past5yrs_herdInc, sep = ",") %>%
  mutate(
    past5yrs_herdInc = str_trim(past5yrs_herdInc),
    past5yrs_herdInc = str_to_lower(past5yrs_herdInc)
  ) %>%
  count(Soum, past5yrs_herdInc, sort = FALSE) %>%
  arrange(past5yrs_herdInc)

past5yrs_herdInc1 <- past5yrs_herdInc1 %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>%  
  ungroup() %>% 
  arrange(desc(Total))
kable(past5yrs_herdInc1)
```



## 8. If your herd size has decreased, what are the reasons?:
  past5yrs_herdDec: 
  
```{r, echo=FALSE}
past5yrs_herdDec1 <- base_LIVESTOCK %>%
  select(Soum, past5yrs_herdDec) %>%
  filter(!is.na(past5yrs_herdDec)) %>%
  separate_rows(past5yrs_herdDec, sep = ",") %>%
  mutate(
    past5yrs_herdDec = str_trim(past5yrs_herdDec),
    past5yrs_herdDec = str_to_lower(past5yrs_herdDec)
  ) %>%
  count(Soum, past5yrs_herdDec, sort = FALSE) %>%
  arrange(past5yrs_herdDec)

past5yrs_herdDec1 <- past5yrs_herdDec1 %>%
  pivot_wider(
    names_from = Soum,
    values_from = n,
    values_fill = 0  
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(-1))) %>%  
  ungroup() %>% 
  arrange(desc(Total))
kable(past5yrs_herdDec1)
```



## 9. Do you have plans to substantially change the size of your herd:
  Column: nextYr_herdChg
  
#### A. All answers: 
```{r, echo=FALSE}
livestock_nextYr_herdChg1 <- base_LIVESTOCK %>%
  select(nextYr_herdChg) %>%
  count(nextYr_herdChg, sort = TRUE)
livestock_nextYr_herdChg1 <- livestock_nextYr_herdChg1 %>%
  pivot_wider(
    names_from = nextYr_herdChg,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(livestock_nextYr_herdChg1)
```

#### B. by Bag: 
```{r, echo=FALSE}
livestock_nextYr_herdChg2 <- base_LIVESTOCK %>%
  select(Soum, bag, nextYr_herdChg) %>%
  group_by(Soum, bag, nextYr_herdChg) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, bag, desc(n))
livestock_nextYr_herdChg2 <- livestock_nextYr_herdChg2 %>%
  pivot_wider(
    names_from = nextYr_herdChg,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)

totals_row <- livestock_nextYr_herdChg2 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL", bag = "") %>%
  select(Soum, bag, everything())

livestock_nextYr_herdChg2 <- bind_rows(livestock_nextYr_herdChg2, totals_row)

kable(livestock_nextYr_herdChg2, n = 33)
```

#### C. by Soum: 
```{r, echo=FALSE}
livestock_nextYr_herdChg3 <- base_LIVESTOCK %>%
  select(Soum, nextYr_herdChg) %>%
  group_by(Soum, nextYr_herdChg) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, desc(n))
livestock_nextYr_herdChg3 <- livestock_nextYr_herdChg3 %>%
  pivot_wider(
    names_from = nextYr_herdChg,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum)

totals_row <- livestock_nextYr_herdChg3 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL") %>%
  select(Soum, everything())

livestock_nextYr_herdChg3 <- bind_rows(livestock_nextYr_herdChg3, totals_row)

kable(livestock_nextYr_herdChg3, n = 33)
```



## 10. If you are changing the herd composition, what are you doing?:
  Column: livestock_nextYr_what
  
#### A. All answers: 
```{r, echo=FALSE}
livestock_nextYr_what1 <- base_LIVESTOCK %>%
  select(nextYr_what) %>%
  count(nextYr_what, sort = TRUE)
livestock_nextYr_what1 <- livestock_nextYr_what1 %>%
  pivot_wider(
    names_from = nextYr_what,
    values_from = n,
    values_fill = 0 
  ) %>%
  rowwise() %>%
  mutate(Total = sum(c_across(where(is.numeric)))) %>%
  ungroup()
kable(livestock_nextYr_what1)
```

#### B. by Bag: 
```{r, echo=FALSE}
livestock_nextYr_what2 <- base_LIVESTOCK %>%
  select(Soum, bag, nextYr_what) %>%
  group_by(Soum, bag, nextYr_what) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, bag, desc(n))
livestock_nextYr_what2 <- livestock_nextYr_what2 %>%
  pivot_wider(
    names_from = nextYr_what,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum, bag)

totals_row <- livestock_nextYr_what2 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL", bag = "") %>%
  select(Soum, bag, everything())

livestock_nextYr_what2 <- bind_rows(livestock_nextYr_what2, totals_row)

kable(livestock_nextYr_what2, n = 33)
```

#### C. by Soum: 
```{r, echo=FALSE}
livestock_nextYr_what3 <- base_LIVESTOCK %>%
  select(Soum, nextYr_what) %>%
  group_by(Soum, nextYr_what) %>%
  summarise(n = n(), .groups = "drop") %>%
  arrange(Soum, desc(n))
livestock_nextYr_what3 <- livestock_nextYr_what3 %>%
  pivot_wider(
    names_from = nextYr_what,
    values_from = n,
    values_fill = 0
  ) %>%
  arrange(Soum)

totals_row <- livestock_nextYr_what3 %>%
  summarise(across(where(is.numeric), sum)) %>%
  mutate(Soum = "TOTAL") %>%
  select(Soum, everything())

livestock_nextYr_what3 <- bind_rows(livestock_nextYr_what3, totals_row)

kable(livestock_nextYr_what3, n = 33)
```



## 11. If you are changing the herd composition, why?:
  Column: nextYr_why
  
```{r, echo=FALSE}
Chg_nextYr_why <- base_LIVESTOCK %>%
  select(nextYr_why) %>%
  filter(!is.na(nextYr_why)) %>%
  mutate(nextYr_why = str_replace(nextYr_why, "Shorter/sparser vegetation, Reduced wild onion abundance Higher number of mice", "shorter/sparser vegetation, reduced wild onion abundance, higher number of mice")
  ) %>%
  separate_rows(nextYr_why, sep = ",") %>%
  mutate(
    nextYr_why = str_trim(nextYr_why),
    nextYr_why = str_to_lower(nextYr_why),
    nextYr_why = case_when(
      nextYr_why == "reduced plant regeneration" ~ "less vegetation overall",
      TRUE ~ nextYr_why
    )
  ) %>%
  count(nextYr_why, sort = TRUE)
kable(Chg_nextYr_why, n = 45)
```
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------


































